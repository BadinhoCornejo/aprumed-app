<style>
  .invalid-feedback {
    display: block;
  }
  .contenedor {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
  }

  .download {
    color: #000000;
    padding: 10px 20px;
    margin-bottom: 20px;
  }
  a {
    text-decoration: underline;
    color: #000000;
  }

  input[type="file" i] {
    background-color: white !important;
    border: 0px !important;
  }
</style>
<h1 mat-dialog-title>Editar: {{ libro.titulo }}</h1>
<div style="display: flex; flex-direction: row;">
  <div style="width: 70%;">
    <form [formGroup]="form">
      <div mat-dialog-content>
        <mat-form-field style="width: 100%;">
          <mat-label>Titulo</mat-label>
          <input
            matInput
            type="text"
            formControlName="titulo"
            placeholder="Ingrese el título"
            [ngClass]="{ 'is-invalid': submitted && f.titulo.errors }"
          />
          <div *ngIf="submitted && f.titulo.errors" class="invalid-feedback">
            <div *ngIf="f.titulo.errors.required">
              Este campo es requerido
            </div>
          </div>
        </mat-form-field>
        <mat-form-field style="width: 100%;">
          <mat-label>Autor</mat-label>
          <input
            matInput
            type="text"
            formControlName="autor"
            placeholder="Ingrese el autor"
            [ngClass]="{ 'is-invalid': submitted && f.autor.errors }"
          />
          <div *ngIf="submitted && f.autor.errors" class="invalid-feedback">
            <div *ngIf="f.autor.errors.required">
              Este campo es requerido
            </div>
          </div>
        </mat-form-field>
        <mat-form-field style="width: 100%;">
          <mat-label>Fecha de publicación</mat-label>
          <input
            matInput
            type="text"
            formControlName="fechaPublicacion"
            placeholder="Ingrese la fecha de publicación"
            [ngClass]="{ 'is-invalid': submitted && f.fechaPublicacion.errors }"
          />
          <div
            *ngIf="submitted && f.fechaPublicacion.errors"
            class="invalid-feedback"
          >
            <div *ngIf="f.fechaPublicacion.errors.required">
              Este campo es requerido
            </div>
            <div *ngIf="f.fechaPublicacion.errors.pattern">
              Por favor siga el patrón (YYYY-MM-AA)
            </div>
          </div>
        </mat-form-field>
        <mat-form-field style="width: 100%;">
          <mat-label>ISBN</mat-label>
          <input
            matInput
            type="text"
            formControlName="isbn"
            placeholder="Ingrese el ISBN"
            [ngClass]="{ 'is-invalid': submitted && f.isbn.errors }"
          />
          <div *ngIf="submitted && f.isbn.errors" class="invalid-feedback">
            <div *ngIf="f.isbn.errors.required">
              Este campo es requerido
            </div>
          </div>
        </mat-form-field>
        <mat-form-field style="width: 100%;">
          <mat-label>Precio</mat-label>
          <input
            matInput
            type="text"
            formControlName="precio"
            placeholder="Ingrese el precio"
            [ngClass]="{ 'is-invalid': submitted && f.precio.errors }"
          />
          <div *ngIf="submitted && f.precio.errors" class="invalid-feedback">
            <div *ngIf="f.precio.errors.required">
              Este campo es requerido
            </div>
            <div *ngIf="f.precio.errors.pattern">
              Por favor ingrese un precio válido
            </div>
          </div>
        </mat-form-field>
        <mat-form-field>
          <mat-label>Categoria</mat-label>
          <mat-select>
            <mat-option
              *ngFor="let categoria of categorias"
              [value]="categoria.categoriaID"
              >{{ categoria.nombreCategoria }}</mat-option
            >
          </mat-select>
        </mat-form-field>
        <mat-slide-toggle
          [color]="color"
          [checked]="isChecked()"
          style="margin-left: 32px;"
        >
          Activo
        </mat-slide-toggle>
      </div>
      <div mat-dialog-actions>
        <button mat-button type="submit" cdkFocusInitial (click)="onSubmit()">
          Guardar
        </button>
        <button mat-button (click)="onNoClick()">Cancelar</button>
      </div>
    </form>
  </div>
  <div style="margin-left: 32px;">
    <div class="contenedor">
      <div class="contenedor_formulario">
        <h1
          style="font-family: 'Noto Sans', sans-serif; font-size: 16px; margin-left: 16px;"
        >
          Subir imagen
        </h1>
        <p class="download" *ngIf="finalizado">
          URL de descarga:
          <a href="{{ URLPublica }}" target="_blank">Descargar</a>
        </p>

        <form
          [formGroup]="archivoForm"
          (ngSubmit)="subirArchivo()"
          style="margin-left: 16px;"
        >
          <div class="file has-name is-boxed">
            <label class="file-label">
              <input
                class="file-input"
                type="file"
                formControlName="archivo"
                (change)="cambioArchivo($event)"
              />
              <span class="file-cta">
                <span class="file-label">
                  Elegir un archivo…
                </span>
              </span>
              <span class="file-name">
                {{ mensajeArchivo }}
              </span>
            </label>
          </div>
          <hr />
          <progress
            *ngIf="porcentaje > 0 && porcentaje < 100"
            class="progress is-large is-success"
            value="{{ porcentaje }}"
            max="100"
            >{{ porcentaje }}%</progress
          >
          <button
            mat-button
            [ngClass]="{
              button: true,
              'is-success': true,
              'is-large': true,
              'is-loading': porcentaje > 0 && porcentaje < 100
            }"
            [disabled]="
              !archivoForm.valid && (porcentaje > 0 && porcentaje < 100)
            "
          >
            Subir archivo
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
